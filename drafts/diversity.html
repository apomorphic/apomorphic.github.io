<!-- Single article page with comments -->
<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="utf-8">
        <title>Diversity - Apomorphic</title>
        <meta name="description" content="">
        <meta name="author" content="Will Bradshaw">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
            <script src="https://apomorphic.com/theme/html5.js"></script>
        <![endif]-->


        <!-- Le styles -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
        <link href="https://apomorphic.com/theme/local.css" rel="stylesheet">
        <link href="https://apomorphic.com/theme/pygments.css" rel="stylesheet">
        <link href="https://apomorphic.com/theme/font-awesome.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'>

    </head>

    <body>
        <header class="blog-header">
            <div class="container">
                <div class="row-fluid">
                    <div class="col-sm-8">
                        <div class="container">
                            <!-- Website headline -->
                            <div class="row-fluid">
                                <a href="https://apomorphic.com" class="brand">Apomorphic</a>
                            </div>
                            <!-- Website tagline/subtitle -->
                            <div class="row-fluid">
                                <span class="tagline">A blog about biology, self-improvement, and the future</span>
                            </div>
                        </div>
                    </div>

                    <!-- Pages in links on right -->
                    <div class="col-sm-4" id="blog-nav">
                        <ul class="nav nav-pills pull-right">
                            <li><a href="https://apomorphic.com/about">About</a></li>
                        </ul>
                    </div>
                </div> <!-- End of fluid row-->
            </div>   <!-- End of Container-->
        </header>

        <main>
        <! -- Main content of page, depending on page type -->
        <div class="container">
            <div class="content">
                <div class="row-fluid">
                    <div class="col-sm-12">
<!-- Main article content (as on homepage) -->
<div class="container">
<!-- Post title -->
<div class="row-fluid">
    <div class="article-title col-md-10 col-sm-12 col-xs-12 col-md-offset-1">
        <a href="https://apomorphic.com/drafts/diversity" id="title">Diversity</a>
    </div>
</div>

<!-- Post info -->
<div class="row-fluid">
    <div class="article-info col-md-10 col-sm-12 col-xs-12 col-md-offset-1">
        <p>Posted on Sun 24 May 2020 by Will Bradshaw</p>
    </div>
</div>

<!-- Post content -->
<div class="row-fluid">
    <div class="article-content col-md-10 col-sm-12 col-xs-12 col-md-offset-1">
        <h2>1</h2>
<p>Imagine you have a box of&nbsp;beetles.</p>
<p>Actually, let&#8217;s say you have lots of boxes. Dozens of boxes of beetles, each with 100 beetles each. It&#8217;s fair to say you have a beetle&nbsp;problem.</p>
<p>One day, your mathematician friend comes to visit, and you show her your beetle collection. &#8220;Wow,&#8221;, she says, &#8220;that&#8217;s a lot of beetles.&#8221; You agree it&#8217;s a lot of beetles, but look at how pretty these red ones&nbsp;are—</p>
<p><span class="dquo">&#8220;</span>Very nice,&#8221; she says, &#8220;but these beetles are all the same. Do you have a <em>more diverse</em> box of&nbsp;beetles?&#8221;</p>
<p>Easy enough. You fetch her a box with ten species, ten beetles each. &#8220;This is better,&#8221; she says, &#8220;very pretty. But is it your <em>most</em> diverse box of&nbsp;beetles?&#8221;</p>
<p>You hesitate. Anything&#8217;s more diverse than a box of identical beetles, but what would make a box more diverse than this&nbsp;one?</p>
<p><span class="dquo">&#8220;</span>Well,&#8221; she says, &#8220;how about a box with more species in&nbsp;it?&#8221;</p>
<p>You don&#8217;t have very many boxes with more than 10 species; whatever strange urge leads you to collect species seems to find 10 species a satisfying number. But you find one with eleven species: 90 beetles of one species, and one each of 10 other species. This cool blue one, and a pretty green one, and this weird purple&nbsp;one—</p>
<p><span class="dquo">&#8220;</span>Hmm,&#8221; says your friend. &#8220;I agree this box has more species, but it doesn&#8217;t <em>feel</em> more diverse to me. Almost all the beetles are the&nbsp;same.&#8221;</p>
<p>How about this box – the same species, but now there&#8217;s only 80 of the common one, and two each of the rare species. &#8220;This is definitely more diverse than the last box,&#8221; she says, &#8220;but I&#8217;m still not sure how it compares to the 10-species&nbsp;one.&#8221;</p>
<p>You&#8217;re not sure you can do any better than that, but under the sofa cushion you find a (slightly squashed) box with 16 species! – with 26, 10, 9, 9, 7, 6, 6, 5, 5, 4, 4, 3, 2, 2, 1, and 1 species&nbsp;each.</p>
<p><span class="dquo">&#8220;</span>I have no idea,&#8221; your mathematician friend says. &#8220;We need to formalise&nbsp;this.&#8221;</p>
<h2>A</h2>
<p><em>Formalise</em> it? Why? Isn&#8217;t it enough just to observe the serene, transcendental beauty of a box of beetles? [<span class="caps">NB</span>: More&nbsp;here?]</p>
<p><span class="dquo">&#8220;</span>Don&#8217;t be stupid,&#8221; she says. [<span class="caps">NB</span> justification&nbsp;here]</p>
<p><span class="dquo">&#8220;</span>Hmm, the obvious place to start would be the <a href="https://en.wikipedia.org/wiki/Species_richness">number of species</a>. But we already saw that didn&#8217;t match my intuition. Box 3 didn&#8217;t seem more diverse than box 2. So we need something&nbsp;else.&#8221;</p>
<p><span class="dquo">&#8220;</span>Okay,&#8221; you say, grabbing a box and getting into the spirit of the thing, &#8220;look at all the beetles crawling around in there. How about: if two beetles bump into each other while moving around at random, what&#8217;s the probability that they&#8217;re from the same&nbsp;species?&#8221;</p>
<p><span class="dquo">&#8220;</span>Simple enough,&#8221; she says, &#8220;that&#8217;s roughly the <a href="https://en.wikipedia.org/wiki/Diversity_index#Simpson_index">sum of the squares of the proportion of beetles in each species</a>. At least, it is if the box contains an infinite number of beetles, and close enough if the number of beetles is&nbsp;large.&#8221;</p>
<p>(&#8220;There&#8217;s only 100 beetles in this box, though,&#8221; you say. &#8220;Shh!&#8221; she says, &#8220;it&#8217;s&nbsp;fine.&#8221;)</p>
<p><span class="dquo">&#8220;</span>Okay, so how about that, then,&#8221; you say, &#8220;that seems like a good diversity&nbsp;measure.&#8221;</p>
<p><span class="dquo">&#8220;</span>Well, it&#8217;s not really a <em>diversity</em>, measure,&#8221; she says. &#8220;It goes down as the number of species goes&nbsp;up.&#8221;</p>
<p><span class="dquo">&#8220;</span>One minus that number, then,&#8221; you say, &#8220;the probability that two beetles are from <em>different</em>&nbsp;species.&#8221;</p>
<p><span class="dquo">&#8220;</span>Yes, that seems fine as a first attempt,&#8221; she says. What would that give us for these five&nbsp;boxes?&#8221;</p>
<p><span class="dquo">&#8220;</span>Correcting for a finite sample,&#8221; you say, glaring at her, &#8220;that gives 0 for the one-species box, 0.91 for the ten-species box, 0.19 and 0.36 for the eleven-species boxes, and 0.89 for the sixteen-species one. That&#8217;s good,&nbsp;right?&#8221;</p>
<p><span class="dquo">&#8220;</span>It matches my intuition for the simple cases,&#8221; your friend says, &#8220;and I feel I learned something about the last box. How do you <em>feed</em> all these beetles,&nbsp;anyway?&#8221;</p>
<p><span class="dquo">&#8220;</span>Uh,&#8221; you&nbsp;say.</p>
<p><span class="dquo">&#8220;</span>Never mind. I feel like there&#8217;s still something I&#8217;m missing&nbsp;here.&#8221;</p>
<h2>א</h2>
<p>Suddenly your friend slaps her forehead. &#8220;Obviously!&#8221; she says, &#8220;this is an information-theory&nbsp;problem.&#8221;</p>
<p><span class="dquo">&#8220;</span>Is it?&#8221; you say, with foreboding. You don&#8217;t know much information theory, you&#8217;re more of a beetles&nbsp;person.</p>
<p><span class="dquo">&#8220;</span>Of course it is,&#8221; your friend says impatiently. &#8220;We have a population of objects, divided into disjoint classes. If we read off the class membership of each object we get a signal. The more diverse the population, the harder it is to predict the next character of the signal. What we want to know is the <em>entropy</em>.&#8221;</p>
<p><span class="dquo">&#8220;</span>Oh,&#8221; you say. You&#8217;re not sure if this is good&nbsp;news.</p>
<p><span class="dquo">&#8220;</span>With the one-species box,&#8221; your friend says, &#8220;the next species is perfectly predictable. No entropy, no diversity. With the ten-species box the entropy was 3.3 bits: as high as it can get with only 10 classes. If you&#8217;d given me a perfectly-even box with 11 species it would have been 3.5 bits, but because most of the beetles in those boxes were from the same species the diversity was lower: 0.55 and 0.96 bits. And the 16-species box has 3.5 bits: more than the 10-species box. So I guess the sixteen-species box was a bit more diverse than the 10-species box after all, even though the most common species makes up more of the&nbsp;population.&#8221;</p>
<p>(&#8220;It&#8217;s impressive that you can do these in your head,&#8221; you say. &#8220;Shh!&#8221; she says&nbsp;again.)</p>
<p><span class="dquo">&#8220;</span>Actually, this tells us something about where our intuitions about diversity are coming from. Entropy increases when the number of states is higher, or when the probabilities of observing those states are more uniform: all else equal, more species is more diversity, but so is more <em>evenness</em> among&nbsp;species.&#8221;</p>
<p>You get the impression your friend is quite pleased with&nbsp;herself.</p>
<h2>I</h2>
<p><span class="dquo">&#8220;</span>Hang on!&#8221; you cry suddenly, &#8220;there&#8217;s a problem here. Actually, two problems. The first is that the complicated sixteen-species box has higher entropy than the ten-species box, but the probability that two random beetles from that box are from different species is <em>lower</em>. Our measures&nbsp;conflict.&#8221;</p>
<p><span class="dquo">&#8220;</span>Your measure is dumb and <em>ad hoc</em>,&#8221; she says, &#8220;my solution is much more elegant, and ties in nicely with other branches of&nbsp;mathematics.&#8221;</p>
<p><span class="dquo">&#8220;</span>I don&#8217;t think there&#8217;s any <em>a priori</em> reason I should care about the Shannon entropy of a population more than my Beetle Index,&#8221; you say stubbornly, &#8220;we&#8217;re not actually trying to encode a signal here, we&#8217;re trying to say something useful about populations. If you can&#8217;t explain clearly why the two measures are giving different results we don&#8217;t know which of them is actually more&nbsp;appropriate.&#8221;</p>
<p><span class="dquo">&#8220;</span>Hmm,&#8221; she says, glaring at you. &#8220;What&#8217;s the second&nbsp;problem?&#8221;</p>
<p><span class="dquo">&#8220;</span>The second problem,&#8221; you say, &#8220;is that these measures are totally incomparable. So far we have three ways of measuring diversity: the number of species, the Beetle Index, and Shannon entropy. But these behave in totally different ways. If I double the number of species in a box while keeping the evenness structure the same, the number of species obviously doubles, the Beetle Index changes in some complicated way, and the Shannon entropy increases by 1. They all operate on different scales and behave in different ways. Trying to work with more than one of these metrics simultaneously seems like a recipe for confusion and&nbsp;error.&#8221;</p>
<p><span class="dquo">&#8220;</span>I&#8217;m not proposing to work with multiple metrics simultaneously,&#8221; your friend says, &#8220;I think Shannon entropy is obviously the best&nbsp;one.&#8221;</p>
<p><span class="dquo">&#8220;</span>Like I said,&#8221; you say, &#8220;you need to give a good account of the differences first, otherwise you&#8217;re throwing away knowledge in the name of&nbsp;elegance.&#8221;</p>
<p><span class="dquo">&#8220;</span>Okay, so,&#8221; your friend says, &#8220;what you want is an account of species diversity that explains why these metrics can move in different directions between cases, and <em>also</em> that allows them to be compared in a simple, intuitive&nbsp;way.&#8221;</p>
<p><span class="dquo">&#8220;</span>Yes, exactly,&#8221; you say. &#8220;That would be&nbsp;great.&#8221;</p>
<p><span class="dquo">&#8220;</span>I&#8217;ll think about it,&#8221; she says. &#8220;Somehow, I suspect I&#8217;ll find just the&nbsp;thing.&#8221;</p>
<h1>ሀ</h1>
<p>==================================================================================================================</p>
<p>[<span class="caps">TODO</span>: Wrangle things so the last box has higher Shannon but lower Simpson, or&nbsp;vice-versa]</p>
<p>There are <span class="math">\(N\)</span> beetles total in the box, and they&#8217;re partitioned into <span class="math">\(C\)</span> species: there are <span class="math">\(n_1\)</span> red beetles, <span class="math">\(n_2\)</span> blue beetles, <span class="math">\(n_3\)</span> green beetles, and so on, such that <span class="math">\(\sum_{k=1}^Cn_k = N\)</span>. </p>
<p>How <em>diverse</em> is the population of beetles? This is a key question in ecology, but diversity questions are not limited to species in a box (or a rainforest). Any time you have a set of <span class="math">\(N\)</span> discrete objects that can be partitioned into <span class="math">\(C\)</span> classes, you can ask diversity questions. The problem is, there&#8217;s no single definition of diversity, and different definitions can give you qualitatively different&nbsp;answers.</p>
<p>Intuitively, there are two things that people generally agree make a population more diverse. The first is <em>richness</em>: how many classes are there? A box containing 50 species of beetles is richer, and thus more diverse, than a box containing 10 species. The second factor is <em>evenness</em>: how are the species distributed? If a population with 10 species is distributed such that each accounts for 10% of individuals, that is intuitively more diverse than if one species accounts for 91% and the rest for 1%&nbsp;each.</p>
<p>So a diversity measure should ideally take both richness and evenness into account when assessing a population; the question is, how? How should one weight richness and evenness when measuring diversity, and what form should the resulting index&nbsp;take?</p>
<p>This turns out to be a moderately knotty problem, but its solution is one of my favourite pieces of biological mathematics. This post is my attempt to communicate why I like it so&nbsp;much.</p>
<h2>Simple diversity&nbsp;indices</h2>
<p>At the extremes, some metrics measure only richness, or only evenness, and neglect the other entirely. The standard way to measure species richness is, well, to count the species<sup id="fnref:chao"><a class="footnote-ref" href="#fn:chao">2</a></sup> and estimate <span class="math">\(C\)</span>. At the other extreme, the Berger-Parker index estimates the relative frequency <span class="math">\(p_x\)</span> of the most frequent species in the population<sup id="fnref:relfreq"><a class="footnote-ref" href="#fn:relfreq">3</a></sup>, giving a decent measure of (un-)evenness but neglecting richness entirely<sup id="fnref:berger"><a class="footnote-ref" href="#fn:berger">4</a></sup>.</p>
<p>In between, you have measures that try to account for both richness and evenness. The oldest of these is Simpson&#8217;s index, which estimates the probability that two randomly selected individuals from a population are from the same species<sup id="fnref:simpson"><a class="footnote-ref" href="#fn:simpson">5</a></sup>:</p>
<p><span class="math">\(L' =&nbsp;\sum_{k=1}^Cp_k^2\)</span></p>
<p>Technically, Simpson&#8217;s index is more of a &#8220;dominance index&#8221; than a diversity index: it <em>decreases</em> as richness or evenness increases. The corresponding <em>diversity</em> index would be <span class="math">\(1-L'\)</span>, the probability of two randomly selected indivduals being from <em>different</em> species, also known as the Gini-Simpson index because ecologists love giving every permutation of every index a different&nbsp;name.</p>
<p>If Simpson&#8217;s index doesn&#8217;t take your fancy, you can try the Shannon entropy. This has about four different related names in the ecological literature, but is nevertheless just the standard measure from information&nbsp;theory:</p>
<p><span class="math">\(H =&nbsp;-\sum_{k=1}^Cp_k\cdot\log{p_k}\)</span></p>
<p>This is nice because it ties ecology to information theory, and converts the diversity question to an information question: if you draw an individual at random from the population, how well can you predict its species? This is affected by both richness and evenness, and so gets fairly neatly at the quantity we&#8217;re trying to estimate: the higher the richness or evenness, the higher the&nbsp;entropy.</p>
<p>Finally, if you&#8217;re feeling fancy, you can use the <em>Rényi entropy</em>, a generalisation of the Shannon entropy with the&nbsp;form</p>
<p><span class="math">\(H_q =&nbsp;\frac{1}{1-q}\log\left[\sum_{k=1}^Cp_k^q\right]\)</span></p>
<p><span class="math">\(q\)</span> is denoted the <em>order</em> of the diversity measure; the Rényi entropy reduces to the Shannon entropy in the limit as <span class="math">\(q \to 1\)</span>, and to <span class="math">\(\log{C}\)</span> at <span class="math">\(q=0\)</span>. </p>
<h2>The&nbsp;problem</h2>
<p>Any of these diversity measures is, considered in isolation, a useful metric. And they seem like they tell you importantly different things about the diversity of a population, such that you&#8217;d really like to be able to use (and compare) multiple different indices at once. Perhaps population <span class="math">\(A\)</span> has higher richness and Berger-Parker estimates but lower Simpson&#8217;s index and Shannon entropy than population <span class="math">\(B\)</span>; it seems like you should be able to learn something useful from that&nbsp;information.</p>
<p>When you actually try to do this though, you immediately run into the problem that these simple indices all have different forms, numeric ranges and biological interpretations that frustrate direct comparisons. Simpson&#8217;s index and the Berger-Parker index range from 0 to 1, with higher values indicating lower diversity, while species richness and Shannon entropy range from 0 to infinity, with higher values indicating <em>higher</em> diversity. Species richness measures diversity linearly, while Shannon entropy measures it in log-scale. And so forth. As a result, while comparing populations using only one index gives you very partial information, comparing them using multiple indices at once typically yields a hard-to-interpret&nbsp;mess.</p>
<p>It would be really nice if we could (a) convert all these different diversity metrics onto a common scale with a common, intuitive interpretation, and (b) accurately and precisely describe how they differ, and what different information you from each. Luckily, this problem was solved in the&nbsp;1970s</p>
<h2>Enter Hill&nbsp;diversities</h2>
<p>In his seminal 1973 paper, Mark Hill lays out the problem of diversity indices, and solves it. He describes how all of the major diversity indices, and several others, can be converted through simple transformations into a common&nbsp;form</p>
<p>The key concept underlying Hill diversity is that of <em>effective richness</em>: given a diversity index for some population, how many species would a <em>perfectly even</em> population need to have to produce the same diversity measurement? For all the diversity measures I describe above, the operation required to get the effective richness is quite simple<sup id="fnref:effrich"><a class="footnote-ref" href="#fn:effrich">6</a></sup>: for Simpson&#8217;s index and the Berger-Parker index, take the reciprocal; for Shanonn and Rényi entropy, exponentiate. Calculating the effective richness in this way transforms all the different diversity indices onto a common, intuitive scale, with minimum diversity at zero and maximum diversity at infinity. More remarkably, after transformation, the effective richness of all of these indices takes a common mathematical&nbsp;form:</p>
<p><span class="math">\({}^qD =&nbsp;\left(\sum_{k=1}^Cp_k^q\right)^{\frac{1}{1-q}}\)</span></p>
<p>As with Rényi entropy, <span class="math">\(q\)</span> here is denoted the <em>diversity order</em>. Different diversity indices (or, more precisely, their effective richnesses) correspond to different diversity orders: species richness to <span class="math">\({}^0D\)</span>, Simpson&#8217;s index to <span class="math">\({}^2D\)</span>, Shannon entropy<sup id="fnref:reynirich"><a class="footnote-ref" href="#fn:reynirich">7</a></sup> to <span class="math">\(\lim_{q \to 1}{}^qD\)</span>, the Berger-Parker index to <span class="math">\(\lim_{q \to \infty}{}^qD\)</span>. A simple, one-parameter function can thus precisely and completely capture all of the most common simple diversity indices, and many others, on a single&nbsp;scale.</p>
<p>How should we interpret <span class="math">\(q\)</span>? Loosely speaking, higher values of <span class="math">\(q\)</span> denote less emphasis on richness and more on evenness. More precisely, higher values of <span class="math">\(q\)</span> give disproportionately greater weight to more common species over rarer species in calculating the effective richness. At <span class="math">\(q = 0\)</span>, all species count equally; at <span class="math">\(q = 1\)</span><sup id="fnref:q1"><a class="footnote-ref" href="#fn:q1">8</a></sup>, each species is weighted proportionally to its abundance; as <span class="math">\(q \to \infty\)</span>, all but the most abundant species are ignored. We can therefore precisely describe the difference between, say, Simpson&#8217;s index and Shannon entropy, when considered as diversity indices: even after correcting for differences in scale and units, the former cares more about common species and less about rare species than the latter. In other words, it is a <em>higher-order</em> measure of&nbsp;diversity.</p>
<h2>On the&nbsp;spectrum</h2>
<p>Once you&#8217;ve worked out how to express all the diversity indices you care about as variants of a single function, differing by a single parameter, you can stop worrying about which index to use and just plot all of&nbsp;them:</p>
<p>[Image of a diversity spectrum&nbsp;here]</p>
<p>Here the <span class="math">\(y\)</span>-axis indicates diversity, the <span class="math">\(x\)</span>-axis indicates diversity order, and each curve represents a population. This is a fairly simple case where one population dominates the other across all diversity orders; in this case we can safely say that the [colour] population is more diverse than the [colour] population, without&nbsp;qualification.</p>
<p>If the curves <em>cross</em>&nbsp;&#8230;</p>
<p>[Image of a diversity spectrum&nbsp;here]</p>
<p>&#8230; then we can loosely say that one is richer and the other is more even, and more precisely specify at which diversity orders each dominates the other. If the curves cross <em>more than once</em>&#8230;</p>
<p>&#8230;then something funny is going on. I don&#8217;t think I&#8217;ve ever seen this in the wild (except when two spectra are very close to each other) but it&#8217;s presumably diagnostic of some very specific diversity&nbsp;structure.</p>
<p>As the previous sentence implies, the theory here is pretty underdeveloped; despite their major advantages, Hill spectra are fairly seldom used in many contexts where they&#8217;d be a big improvement on the status quo (<em>cough</em>microbiota<em>cough</em>), so there hasn&#8217;t been as much theoretical work on them as I&#8217;d like. I&#8217;d love to get to the point where, after reading the relevant literature, you can glance at a diversity spectrum and quickly read off everything it tells you about the structure of the populations in question, but we&#8217;re not there&nbsp;yet.</p>
<p>Even so, Hill diversity spectra are a big leap forward over what came before, and are starting to see gradual uptake in some fields where diversity questions are important (e.g. my erstwhile field of computational immunology). I also just find them very mathematically pleasing, and I wanted to share that&nbsp;here.</p>
<h2>Next&nbsp;steps</h2>
<p>The simple Hill spectra described here don&#8217;t tell you everything you might want to know about the diversity of a population. Most fundamentally, they only allow one level of grouping: one population, composed of species, composed of individuals. Often you want to investigate and compare <em>structured populations</em>, in which individuals are partitioned into subpopulations that differ in their species composition. There are well-developed mathematicaly tools for making that extension, which I hope to cover in a future&nbsp;post.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:complicated">
<p>Not actually all that complicated, just a little convoluted. In the infinite-sample case, doubling the number of species halves the value of the Simpson index (the probability of two random individuals coming from the same species). Converting that to the Gini-Simpson index (the probability of two random individuals coming from different species), if <span class="math">\(GS_k\)</span> is the value of the index for <span class="math">\(kn\)</span> species (where <span class="math">\(n\)</span> is the original number of species), <span class="math">\(GS_{2k} = \frac{1}{2}GS_k + \frac{1}{2}\)</span>.&#160;<a class="footnote-backref" href="#fnref:complicated" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:chao">
<p>Often species richness measurements apply some sort of correction factor, such as the Chao1 or Chao2 estimators, to correct for unobserved species, which are of particular concern in richness focused metrics.&#160;<a class="footnote-backref" href="#fnref:chao" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:relfreq">
<p>Where <span class="math">\(p_x = \frac{n_x}{N}\)</span>.&#160;<a class="footnote-backref" href="#fnref:relfreq" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:berger">
<p>The Berger-Parker index apparently does surprisingly well as an informative diversity metric. It&#8217;s also very resistant to sampling issues.&#160;<a class="footnote-backref" href="#fnref:berger" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:simpson">
<p>Technically this is the infinite-population approximation of Simpson&#8217;s index; when the population is small, you actually want
<span class="math">\(L = \frac{\sum_{k=1}^Cn_k(n_k-1)}{N(N-1)}\)</span>, but this is mathematically uglier and seldom used.&#160;<a class="footnote-backref" href="#fnref:simpson" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:effrich">
<p>Obviously, if your diversity measure is species richness, you don&#8217;t need a transformation: the effective richness is the same as the actual richness.&#160;<a class="footnote-backref" href="#fnref:effrich" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:reynirich">
<p>Fairly obviously, the Rényi entropy of order <span class="math">\(q\)</span> corresponds to the Hill diversity at order <span class="math">\(q\)</span>, and in fact the latter is simply the exponential of the former.&#160;<a class="footnote-backref" href="#fnref:reynirich" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:q1">
<p>The equation for Hill diversity is undefined at <span class="math">\(q = 1\)</span>, but <em>is</em> defined in the limit as <span class="math">\(q \to 1\)</span>, and is continuous if you substitute the latter value for the former. So everyone does.&#160;<a class="footnote-backref" href="#fnref:q1" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:future">
<p>If not, and you&#8217;re especially interested, this wonderfully angry paper covers the topic quite thoroughly.
[<span class="caps">TODO</span>: cite jost paper]&#160;<a class="footnote-backref" href="#fnref:future" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:unifrac">
<p>A second weakness, which is more fundamental, is the lack of degrees of relatedness between species. In biology and elsewhere, one often wants to be able to treat some species pairs as more different than others, but neither the simple indices nor Hill spectra allow you to do that. A common approach to this kind of phylogeny-aware diversity measurement is UniFrac (and its various descendents). There are obvious and significant advantages to this approach, but to my knowledge they haven&#8217;t yet solved the diversity-order problem anywhere near as well as Hill spectra have.&#160;<a class="footnote-backref" href="#fnref:unifrac" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div>
</div>

<!-- Tags and categories -->
<div class="row-fluid">
    <div class="article-info col-md-10 col-sm-12 col-xs-12 col-md-offset-1">
        <p>Posted in <a href="https://apomorphic.com/category/drafts.html">drafts</a>  | Tagged as <a href="https://apomorphic.com/tag/evolution.html">evolution</a>, <a href="https://apomorphic.com/tag/statistics.html">statistics</a>, <a href="https://apomorphic.com/tag/diversity.html">diversity</a></p>
    </div>
</div></div>

<! -- Comments -->
<div class="container">
    <div class="article-comments col-sm-10">
        <h3 id="disqus_title_header">Comments</h3>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'apomorphic';
            var disqus_title = 'Diversity';

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</div>

                    </div>
                </div>             </div>         </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


    </body>
</html>